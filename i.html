<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HK Royals</title>
  <!-- Leaflet CSS removed as per no CSS request -->
</head>
<body>

  <header>
    <h1>HK ROYALS</h1>
  </header>

  <main>

    <section aria-label="Products" role="list">
      <article class="product" role="listitem">
        <img src="gt650.jpeg" alt="GT 650" draggable="true" id="gt" onclick="highlight(this)" ondragstart="drag(event)" />
        <p><strong>GT 650</strong></p>
      </article>

      <article class="product" role="listitem">
        <img src="interceptor.jfif" alt="Interceptor" draggable="true" id="int" onclick="highlight(this)" ondragstart="drag(event)" />
        <p><strong>Interceptor</strong></p>
      </article>
    </section>

    <section id="cart" aria-label="Shopping cart" ondrop="drop(event)" ondragover="allowDrop(event)">
      <strong>Drop your selected products here</strong>
    </section>

    <section aria-label="Map">
      <div id="map" style="height: 350px; width: 90%; margin: 1em auto;"></div>
    </section>

    <section class="media-section" aria-label="Product Demo Media">
      <h2>Product Demo</h2>

      <video width="320" height="240" controls>
        <source src="re.mp4" type="video/mp4" />
        Your browser does not support the video tag.
      </video>

      <br />

      <audio controls>
        <source src="re.mp3" type="audio/mpeg" />
        Your browser does not support the audio element.
      </audio>
    </section>

  </main>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // Map setup
    const map = L.map('map').setView([11.0168, 76.9558], 13);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
    }).addTo(map);

    navigator.geolocation.getCurrentPosition(function(position) {
      const lat = position.coords.latitude;
      const lon = position.coords.longitude;
      map.setView([lat, lon], 13);
      L.marker([lat, lon]).addTo(map).bindPopup("You are here!").openPopup();
    });

    let clickMarker;
    map.on('click', function(e) {
      if (clickMarker) map.removeLayer(clickMarker);
      const lat = e.latlng.lat.toFixed(4);
      const lon = e.latlng.lng.toFixed(4);
      clickMarker = L.marker([lat, lon]).addTo(map)
        .bindPopup("Clicked Location<br>Lat: " + lat + "<br>Lon: " + lon).openPopup();
    });

    // Highlight product
    function highlight(img) {
      document.querySelectorAll('.product img').forEach(el => el.classList.remove('active'));
      img.classList.add('active');
    }

    // Drag and drop
    function allowDrop(ev) {
      ev.preventDefault();
    }

    function drag(ev) {
      ev.dataTransfer.setData("text", ev.target.id);
    }

    function drop(ev) {
      ev.preventDefault();
      var data = ev.dataTransfer.getData("text");
      var item = document.getElementById(data).cloneNode(true);
      item.removeAttribute('id'); // prevent ID conflicts
      ev.target.appendChild(item);
    }
  </script>
</body>
</html>
